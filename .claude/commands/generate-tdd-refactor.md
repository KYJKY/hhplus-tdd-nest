Improve the code while keeping all tests passing.

Areas to improve:
- Remove duplication (apply the DRY principle)
- Extract and simplify functions/methods
- Improve variable and function names
- Apply suitable design patterns
- Optimize performance
- Enhance code readability

After each refactor, verify that all tests still pass.
